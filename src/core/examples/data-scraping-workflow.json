{
  "config": {
    "id": "data-scraping-workflow",
    "name": "æ•°æ®æŠ“å–ä¸åˆ†æå·¥ä½œæµ"
  },
  "nodes": [
    {
      "config": {
        "id": "timer-trigger",
        "name": "å®šæ—¶è§¦å‘å™¨",
        "type": "timer-trigger"
      },
      "settings": {
        "interval": 3600000
      },
      "originalSettings": {
        "interval": 3600000
      }
    },
    {
      "config": {
        "id": "fetch-api-data",
        "name": "HTTPè¯·æ±‚",
        "type": "http-request"
      },
      "settings": {
        "url": "https://api.coindesk.com/v1/bpi/currentprice.json",
        "method": "GET",
        "headers": {
          "User-Agent": "DataScrapingBot/1.0",
          "Accept": "application/json"
        },
        "timeout": 30000
      },
      "originalSettings": {
        "url": "https://api.coindesk.com/v1/bpi/currentprice.json",
        "method": "GET",
        "headers": {
          "User-Agent": "DataScrapingBot/1.0",
          "Accept": "application/json"
        },
        "timeout": 30000
      }
    },
    {
      "config": {
        "id": "process-data",
        "name": "ä»£ç æ‰§è¡Œ",
        "type": "code"
      },
      "settings": {
        "code": "\n      // å¤„ç†æ¯”ç‰¹å¸ä»·æ ¼æ•°æ®\n      const data = inputs.data;\n      const bpi = data.bpi;\n      \n      const processedData = {\n        timestamp: new Date().toISOString(),\n        prices: {\n          usd: parseFloat(bpi.USD.rate.replace(',', '')),\n          eur: parseFloat(bpi.EUR.rate.replace(',', '')),\n          gbp: parseFloat(bpi.GBP.rate.replace(',', ''))\n        },\n        lastUpdated: data.time.updated,\n        disclaimer: data.disclaimer\n      };\n      \n      // è®¡ç®—ä»·æ ¼è¶‹åŠ¿ï¼ˆæ¨¡æ‹Ÿï¼‰\n      const previousPrice = 45000; // æ¨¡æ‹Ÿå‰ä¸€æ¬¡ä»·æ ¼\n      const currentPrice = processedData.prices.usd;\n      const priceChange = ((currentPrice - previousPrice) / previousPrice * 100).toFixed(2);\n      \n      processedData.analysis = {\n        priceChange: parseFloat(priceChange),\n        trend: priceChange > 0 ? 'up' : 'down',\n        volatility: Math.abs(priceChange) > 5 ? 'high' : 'normal'\n      };\n      \n      return {\n        processedData,\n        shouldAlert: Math.abs(priceChange) > 10\n      };\n    "
      },
      "originalSettings": {
        "code": "\n      // å¤„ç†æ¯”ç‰¹å¸ä»·æ ¼æ•°æ®\n      const data = inputs.data;\n      const bpi = data.bpi;\n      \n      const processedData = {\n        timestamp: new Date().toISOString(),\n        prices: {\n          usd: parseFloat(bpi.USD.rate.replace(',', '')),\n          eur: parseFloat(bpi.EUR.rate.replace(',', '')),\n          gbp: parseFloat(bpi.GBP.rate.replace(',', ''))\n        },\n        lastUpdated: data.time.updated,\n        disclaimer: data.disclaimer\n      };\n      \n      // è®¡ç®—ä»·æ ¼è¶‹åŠ¿ï¼ˆæ¨¡æ‹Ÿï¼‰\n      const previousPrice = 45000; // æ¨¡æ‹Ÿå‰ä¸€æ¬¡ä»·æ ¼\n      const currentPrice = processedData.prices.usd;\n      const priceChange = ((currentPrice - previousPrice) / previousPrice * 100).toFixed(2);\n      \n      processedData.analysis = {\n        priceChange: parseFloat(priceChange),\n        trend: priceChange > 0 ? 'up' : 'down',\n        volatility: Math.abs(priceChange) > 5 ? 'high' : 'normal'\n      };\n      \n      return {\n        processedData,\n        shouldAlert: Math.abs(priceChange) > 10\n      };\n    "
      }
    },
    {
      "config": {
        "id": "price-alert-condition",
        "name": "æ¡ä»¶åˆ¤æ–­",
        "type": "condition"
      },
      "settings": {
        "conditionType": "javascript",
        "condition": "inputs.shouldAlert === true"
      },
      "originalSettings": {
        "conditionType": "javascript",
        "condition": "inputs.shouldAlert === true"
      }
    },
    {
      "config": {
        "id": "market-analysis",
        "name": "AI Agent",
        "type": "agent"
      },
      "settings": {
        "systemPrompt": "ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„åŠ å¯†è´§å¸å¸‚åœºåˆ†æå¸ˆã€‚è¯·åŸºäºæä¾›çš„æ¯”ç‰¹å¸ä»·æ ¼æ•°æ®ç”Ÿæˆç®€æ´çš„å¸‚åœºåˆ†ææŠ¥å‘Šã€‚\n    \n    æŠ¥å‘Šåº”è¯¥åŒ…æ‹¬ï¼š\n    1. å½“å‰ä»·æ ¼æ¦‚å†µ\n    2. ä»·æ ¼å˜åŒ–è¶‹åŠ¿åˆ†æ\n    3. å¸‚åœºæƒ…ç»ªè¯„ä¼°\n    4. ç®€çŸ­çš„æŠ•èµ„å»ºè®®ï¼ˆä»…ä¾›å‚è€ƒï¼‰\n    \n    è¯·ä¿æŒä¸“ä¸šã€å®¢è§‚çš„åˆ†æé£æ ¼ã€‚",
        "model": "gpt-4"
      },
      "originalSettings": {
        "systemPrompt": "ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„åŠ å¯†è´§å¸å¸‚åœºåˆ†æå¸ˆã€‚è¯·åŸºäºæä¾›çš„æ¯”ç‰¹å¸ä»·æ ¼æ•°æ®ç”Ÿæˆç®€æ´çš„å¸‚åœºåˆ†ææŠ¥å‘Šã€‚\n    \n    æŠ¥å‘Šåº”è¯¥åŒ…æ‹¬ï¼š\n    1. å½“å‰ä»·æ ¼æ¦‚å†µ\n    2. ä»·æ ¼å˜åŒ–è¶‹åŠ¿åˆ†æ\n    3. å¸‚åœºæƒ…ç»ªè¯„ä¼°\n    4. ç®€çŸ­çš„æŠ•èµ„å»ºè®®ï¼ˆä»…ä¾›å‚è€ƒï¼‰\n    \n    è¯·ä¿æŒä¸“ä¸šã€å®¢è§‚çš„åˆ†æé£æ ¼ã€‚",
        "model": "gpt-4"
      }
    },
    {
      "config": {
        "id": "send-notification",
        "name": "HTTPè¯·æ±‚",
        "type": "http-request"
      },
      "settings": {
        "url": "https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK",
        "method": "POST",
        "headers": {
          "Content-Type": "application/json"
        },
        "timeout": 10000,
        "bodyTemplate": "{\n      \"text\": \"ğŸš¨ æ¯”ç‰¹å¸ä»·æ ¼è­¦æŠ¥\",\n      \"attachments\": [\n        {\n          \"color\": \"{{inputs.analysis.trend === 'up' ? 'good' : 'danger'}}\",\n          \"fields\": [\n            {\n              \"title\": \"å½“å‰ä»·æ ¼\",\n              \"value\": \"${{inputs.processedData.prices.usd}}\",\n              \"short\": true\n            },\n            {\n              \"title\": \"ä»·æ ¼å˜åŒ–\",\n              \"value\": \"{{inputs.analysis.priceChange}}%\",\n              \"short\": true\n            },\n            {\n              \"title\": \"AIåˆ†æ\",\n              \"value\": \"{{inputs.aiAnalysis}}\",\n              \"short\": false\n            }\n          ]\n        }\n      ]\n    }"
      },
      "originalSettings": {
        "url": "https://hooks.slack.com/services/YOUR/SLACK/WEBHOOK",
        "method": "POST",
        "headers": {
          "Content-Type": "application/json"
        },
        "timeout": 10000,
        "bodyTemplate": "{\n      \"text\": \"ğŸš¨ æ¯”ç‰¹å¸ä»·æ ¼è­¦æŠ¥\",\n      \"attachments\": [\n        {\n          \"color\": \"{{inputs.analysis.trend === 'up' ? 'good' : 'danger'}}\",\n          \"fields\": [\n            {\n              \"title\": \"å½“å‰ä»·æ ¼\",\n              \"value\": \"${{inputs.processedData.prices.usd}}\",\n              \"short\": true\n            },\n            {\n              \"title\": \"ä»·æ ¼å˜åŒ–\",\n              \"value\": \"{{inputs.analysis.priceChange}}%\",\n              \"short\": true\n            },\n            {\n              \"title\": \"AIåˆ†æ\",\n              \"value\": \"{{inputs.aiAnalysis}}\",\n              \"short\": false\n            }\n          ]\n        }\n      ]\n    }"
      }
    }
  ],
  "connections": [
    {
      "id": "timer-to-fetch",
      "sourceNodeId": "timer-trigger",
      "targetNodeId": "fetch-api-data"
    },
    {
      "id": "fetch-to-process",
      "sourceNodeId": "fetch-api-data",
      "targetNodeId": "process-data"
    },
    {
      "id": "process-to-condition",
      "sourceNodeId": "process-data",
      "targetNodeId": "price-alert-condition"
    },
    {
      "id": "condition-to-ai",
      "sourceNodeId": "price-alert-condition",
      "targetNodeId": "market-analysis"
    },
    {
      "id": "ai-to-notification",
      "sourceNodeId": "market-analysis",
      "targetNodeId": "send-notification"
    }
  ],
  "metadata": {
    "version": "1.0.0",
    "createdAt": "2024-12-19T10:00:00.000Z",
    "updatedAt": "2024-12-19T10:00:00.000Z",
    "description": "è‡ªåŠ¨æŠ“å–æ¯”ç‰¹å¸ä»·æ ¼æ•°æ®ï¼Œè¿›è¡Œåˆ†æå¹¶åœ¨ä»·æ ¼æ³¢åŠ¨è¶…è¿‡é˜ˆå€¼æ—¶å‘é€è­¦æŠ¥é€šçŸ¥ã€‚åŒ…å«æ•°æ®å¤„ç†ã€AIåˆ†æå’Œé€šçŸ¥å‘é€åŠŸèƒ½ã€‚"
  }
}
