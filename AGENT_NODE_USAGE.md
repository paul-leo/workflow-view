# AgentNode å·¥å…·æ”¯æŒä½¿ç”¨æŒ‡å—

## æ¦‚è¿°

AgentNode ç°åœ¨æ”¯æŒæŒ‚è½½å¤šä¸ªå·¥å…·ï¼Œè®© AI æ™ºèƒ½ä½“èƒ½å¤Ÿè°ƒç”¨å„ç§å·¥å…·æ¥å®Œæˆå¤æ‚ä»»åŠ¡ã€‚æœ¬æŒ‡å—å°†ä»‹ç»å¦‚ä½•ä½¿ç”¨è¿™äº›æ–°åŠŸèƒ½ã€‚

## ğŸš€ æ–°åŠŸèƒ½ç‰¹æ€§

### âœ… å·²å®ç°çš„åŠŸèƒ½

- **å·¥å…·ç®¡ç†ç³»ç»Ÿ**ï¼šæ”¯æŒæ·»åŠ ã€ç§»é™¤å’Œç®¡ç†å¤šä¸ªå·¥å…·
- **å†…ç½®å·¥å…·åº“**ï¼šæä¾› 5 ä¸ªå¸¸ç”¨å·¥å…·ï¼ˆè®¡ç®—å™¨ã€æœç´¢ã€ä»£ç æ‰§è¡Œã€æ–‡æœ¬å¤„ç†ã€æ—¶é—´å·¥å…·ï¼‰
- **ç‹¬ç«‹å·¥å…·èŠ‚ç‚¹**ï¼šå·¥å…·ä½œä¸ºç‹¬ç«‹èŠ‚ç‚¹æ¸²æŸ“åˆ° ReactFlow ç”»å¸ƒä¸­
- **è™šçº¿è¿æ¥**ï¼šAgent èŠ‚ç‚¹ä¸å·¥å…·èŠ‚ç‚¹é€šè¿‡è™šçº¿è¿æ¥
- **å·¥å…·èŠ‚ç‚¹æ¸²æŸ“å™¨**ï¼šä¸“é—¨çš„ ToolNodeRendererï¼Œæ”¯æŒåˆ†ç±»é¢œè‰²å’ŒçŠ¶æ€æ˜¾ç¤º
- **å·¥å…·è°ƒç”¨å†å²**ï¼šæ˜¾ç¤ºæœ€è¿‘çš„å·¥å…·è°ƒç”¨ç»“æœ
- **ç±»å‹å®‰å…¨**ï¼šå®Œæ•´çš„ TypeScript ç±»å‹æ”¯æŒ

### ğŸ¨ è§†è§‰æ•ˆæœ

- **ç´«è‰²ä¸»é¢˜**ï¼šAgent èŠ‚ç‚¹ä½¿ç”¨ç´«è‰²ä¸»é¢˜è‰²
- **ç‹¬ç«‹å·¥å…·èŠ‚ç‚¹**ï¼šå·¥å…·ä½œä¸ºç‹¬ç«‹çš„è™šçº¿è¾¹æ¡†èŠ‚ç‚¹æ˜¾ç¤ºåœ¨ Agent å³ä¾§
- **åˆ†ç±»é¢œè‰²**ï¼šä¸åŒç±»åˆ«çš„å·¥å…·ä½¿ç”¨ä¸åŒé¢œè‰²æ ‡è¯†
- **è™šçº¿è¿æ¥**ï¼šAgent ä¸å·¥å…·èŠ‚ç‚¹ä¹‹é—´çš„è™šçº¿è¿æ¥ï¼Œå¸¦æœ‰å·¥å…·åç§°æ ‡ç­¾
- **åŠ¨ç”»æ•ˆæœ**ï¼šè¿æ¥çº¿æœ‰è„‰å†²åŠ¨ç”»æ•ˆæœ
- **çŠ¶æ€æŒ‡ç¤º**ï¼šæ˜¾ç¤ºå·¥å…·è°ƒç”¨æˆåŠŸ/å¤±è´¥çŠ¶æ€

## ğŸ“š ä½¿ç”¨æ–¹æ³•

### 1. åˆ›å»ºå¸¦å·¥å…·çš„ Agent èŠ‚ç‚¹

```typescript
import { AgentNode } from './src/core/nodes/AgentNode';
import { getAllBuiltinTools } from './src/core/tools/BuiltinTools';

// åˆ›å»º Agent èŠ‚ç‚¹
const agent = new AgentNode('my-agent', {
  systemPrompt: 'ä½ æ˜¯ä¸€ä¸ªæ™ºèƒ½åŠ©æ‰‹ï¼Œå¯ä»¥ä½¿ç”¨å·¥å…·æ¥å¸®åŠ©ç”¨æˆ·ã€‚',
  model: 'gpt-4',
  enableTools: true,      // å¯ç”¨å·¥å…·æ”¯æŒ
  maxToolCalls: 5         // æœ€å¤§å·¥å…·è°ƒç”¨æ¬¡æ•°
});

// æ·»åŠ æ‰€æœ‰å†…ç½®å·¥å…·
const tools = getAllBuiltinTools();
tools.forEach(tool => agent.addTool(tool));

// æˆ–è€…æ·»åŠ ç‰¹å®šå·¥å…·
import { CalculatorTool, WebSearchTool } from './src/core/tools/BuiltinTools';
agent.addTool(CalculatorTool);
agent.addTool(WebSearchTool);
```

### 2. åœ¨å·¥ä½œæµ JSON ä¸­é…ç½®

```json
{
  "id": "agent-1",
  "config": {
    "id": "agent-1",
    "name": "æ™ºèƒ½åŠ©æ‰‹",
    "type": "agent"
  },
  "settings": {
    "systemPrompt": "ä½ æ˜¯ä¸€ä¸ªæ™ºèƒ½åŠ©æ‰‹...",
    "model": "gpt-4",
    "enableTools": true,
    "maxToolCalls": 10
  },
  "tools": [
    {
      "id": "calculator",
      "name": "è®¡ç®—å™¨",
      "description": "æ‰§è¡Œæ•°å­¦è¿ç®—",
      "category": "æ•°å­¦"
    },
    {
      "id": "web-search",
      "name": "ç½‘ç»œæœç´¢",
      "description": "æœç´¢ç½‘ç»œä¿¡æ¯",
      "category": "æœç´¢"
    }
  ]
}
```

## ğŸ› ï¸ å†…ç½®å·¥å…·

### 1. è®¡ç®—å™¨å·¥å…· (CalculatorTool)
- **åŠŸèƒ½**ï¼šæ‰§è¡ŒåŸºæœ¬æ•°å­¦è¿ç®—
- **å‚æ•°**ï¼š`expression` - æ•°å­¦è¡¨è¾¾å¼
- **ç¤ºä¾‹**ï¼š`"2 + 3 * 4"` â†’ `14`

### 2. ç½‘ç»œæœç´¢å·¥å…· (WebSearchTool)
- **åŠŸèƒ½**ï¼šæ¨¡æ‹Ÿç½‘ç»œæœç´¢
- **å‚æ•°**ï¼š`query` - æœç´¢å…³é”®è¯ï¼Œ`limit` - ç»“æœæ•°é‡
- **ç¤ºä¾‹**ï¼šæœç´¢ "äººå·¥æ™ºèƒ½" è¿”å›ç›¸å…³ç»“æœ

### 3. ä»£ç æ‰§è¡Œå™¨ (CodeExecutorTool)
- **åŠŸèƒ½**ï¼šå®‰å…¨æ‰§è¡Œ JavaScript ä»£ç 
- **å‚æ•°**ï¼š`code` - ä»£ç ç‰‡æ®µï¼Œ`timeout` - è¶…æ—¶æ—¶é—´
- **å®‰å…¨é™åˆ¶**ï¼šç¦æ­¢å±é™©æ“ä½œï¼Œæ²™ç®±ç¯å¢ƒ

### 4. æ–‡æœ¬å¤„ç†å™¨ (TextProcessorTool)
- **åŠŸèƒ½**ï¼šæ–‡æœ¬ç»Ÿè®¡ã€æ ¼å¼åŒ–ã€è½¬æ¢
- **æ“ä½œ**ï¼š`count`, `uppercase`, `lowercase`, `reverse`, `summary`
- **ç¤ºä¾‹**ï¼šç»Ÿè®¡æ–‡æœ¬å­—æ•°ã€è½¬æ¢å¤§å°å†™ç­‰

### 5. æ—¶é—´å·¥å…· (TimeTool)
- **åŠŸèƒ½**ï¼šæ—¶é—´è·å–ã€æ ¼å¼åŒ–ã€è®¡ç®—
- **æ“ä½œ**ï¼š`current`, `format`, `add`, `diff`
- **ç¤ºä¾‹**ï¼šè·å–å½“å‰æ—¶é—´ã€è®¡ç®—æ—¶é—´å·®ç­‰

## ğŸ¨ è‡ªå®šä¹‰å·¥å…·

### åˆ›å»ºè‡ªå®šä¹‰å·¥å…·

```typescript
import { z } from 'zod';
import type { Tool } from './src/core/types/Tool';

const MyCustomTool: Tool = {
  id: 'my-tool',
  name: 'æˆ‘çš„å·¥å…·',
  description: 'è¿™æ˜¯ä¸€ä¸ªè‡ªå®šä¹‰å·¥å…·',
  category: 'è‡ªå®šä¹‰',
  icon: MyIcon, // React ç»„ä»¶
  parameters: z.object({
    input: z.string().describe('è¾“å…¥å‚æ•°')
  }),
  
  async execute(input, context) {
    // å®ç°å·¥å…·é€»è¾‘
    return {
      result: `å¤„ç†ç»“æœ: ${input.input}`,
      timestamp: Date.now()
    };
  }
};

// æ·»åŠ åˆ° Agent èŠ‚ç‚¹
agent.addTool(MyCustomTool);
```

## ğŸ–¼ï¸ æ¸²æŸ“å™¨è‡ªå®šä¹‰

AgentNodeRenderer è‡ªåŠ¨å¤„ç†å·¥å…·çš„æ˜¾ç¤ºï¼š

- **å·¥å…·åˆ—è¡¨**ï¼šæ˜¾ç¤ºå‰ 3 ä¸ªå·¥å…·ï¼Œè¶…å‡ºæ˜¾ç¤º "+N æ›´å¤š"
- **å·¥å…·è¿æ¥ç‚¹**ï¼šå³ä¾§è™šçº¿è¿æ¥ç‚¹ï¼Œæœ€å¤šæ˜¾ç¤º 3 ä¸ª
- **è°ƒç”¨å†å²**ï¼šæ˜¾ç¤ºæœ€è¿‘ 2 æ¬¡å·¥å…·è°ƒç”¨ç»“æœ
- **çŠ¶æ€æŒ‡ç¤º**ï¼šæˆåŠŸ/å¤±è´¥å›¾æ ‡

## ğŸ“ å·¥ä½œæµç¤ºä¾‹

æŸ¥çœ‹ `/src/core/examples/agent-workflow-example.json` è·å–å®Œæ•´çš„å·¥ä½œæµé…ç½®ç¤ºä¾‹ã€‚

## ğŸ”§ å¼€å‘è°ƒè¯•

### è¿è¡Œç¤ºä¾‹

```typescript
// åœ¨æµè§ˆå™¨æ§åˆ¶å°ä¸­
import { executeAgentExample } from './src/core/examples/agent-usage-demo';
executeAgentExample();
```

### æŸ¥çœ‹å·¥å…·è°ƒç”¨

```typescript
const result = await agent.execute(input, context);
if (result.data?.toolCalls) {
  console.log('å·¥å…·è°ƒç”¨:', result.data.toolCalls);
}
```

## ğŸ¯ æœ€ä½³å®è·µ

1. **åˆç†è®¾ç½® maxToolCalls**ï¼šé¿å…æ— é™å¾ªç¯è°ƒç”¨
2. **æä¾›æ¸…æ™°çš„ systemPrompt**ï¼šæŒ‡å¯¼ AI ä½•æ—¶ä½¿ç”¨å·¥å…·
3. **å·¥å…·åˆ†ç±»ç®¡ç†**ï¼šä½¿ç”¨ category å­—æ®µç»„ç»‡å·¥å…·
4. **é”™è¯¯å¤„ç†**ï¼šæ£€æŸ¥å·¥å…·è°ƒç”¨ç»“æœçš„ success å­—æ®µ
5. **æ€§èƒ½è€ƒè™‘**ï¼šå¤§é‡å·¥å…·æ—¶è€ƒè™‘æŒ‰éœ€åŠ è½½

## ğŸš§ åç»­è®¡åˆ’

- [ ] LLM æä¾›è€…æ¥å£å®ç°
- [ ] æ›´å¤šå†…ç½®å·¥å…·
- [ ] å·¥å…·æƒé™ç®¡ç†
- [ ] å·¥å…·è°ƒç”¨é“¾å¯è§†åŒ–
- [ ] å·¥å…·æ€§èƒ½ç›‘æ§

## ğŸ“ æ”¯æŒ

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®ï¼Œè¯·æŸ¥çœ‹ä»£ç ä¸­çš„è¯¦ç»†æ³¨é‡Šæˆ–æäº¤ Issueã€‚
